(function(a){var i={},e="lb_login";MOGU.user_handsome_login_init=function(b){(function(){var c=MOGUPROFILE.showqq;if(typeof c!="undefined"&&c=="is_qzone")return!1;a(".light_box").remove();c=MOGUPROFILE.is_subsite==1?"\u767b\u5f55\u8611\u83c7\u5bb6":"\u767b\u5f55\u8611\u83c7\u8857";b=b||c;c={};c.sinaurl="/oauth/login/sina/"+(MOGUPROFILE.is_subsite==1?"mogujia":"mogujie");c.taobaourl="/oauth/login/taobao/"+(MOGUPROFILE.is_subsite==1?"mogujia":"mogujie");c.qqurl="/oauth/login/qq/"+(MOGUPROFILE.is_subsite==
1?"mogujia":"mogujie");c=doT.template('<div class="login_box clearfix"><p class="login_fail imgcheckclear">\u8bf7\u8f93\u5165\u5bc6\u7801\uff01</p><div class="login_form"><dl><dd>\u7528\u6237\u540d\uff1a</dd><dt><input type="text" name="user_email" class="text"></dt><dd>\u5bc6\u3000\u7801\uff1a</dd><dt class="u_passwd"><input type="password" name="user_pass" class="text"><a href="/usersecurity/findpwd">\u5fd8\u8bb0\u5bc6\u7801\uff1f</a></dt><dd>&nbsp;</dd><dt class="rem"><input type="checkbox" name="remember" class="checkbox" checked="">\u4e24\u5468\u5185\u514d\u767b\u5f55</dt><dd>&nbsp;</dd><dt><input type="button" value="" class="login_btn"><a href="/register?isElegant=1" class="register_btn"></a></dt></dl></div><div class="reg_or_weibo"><div class="register_box">\u5176\u4ed6\u767b\u9646\u65b9\u5f0f<a href="{{=it.qqurl}}" class="login_a" ></a></div><div class="l_o"><a href="{{=it.sinaurl}}">\u7528\u5fae\u535a\u5e10\u53f7\u767b\u5f55</a><a style="background-position: 0 -51px;" href="{{=it.taobaourl}}">\u7528\u6dd8\u5b9d\u5e10\u53f7\u767b\u5f55</a></div></div></div>')(c);
i=new MGLightBox({title:b,lightBoxId:e,contentHtml:c,scroll:!0});i.init();a("#lb_login input[name=user_email]").focus()})()};MOGU.user_handsome_login=function(b,c){function h(d,c){a("#"+e+" .login_fail").text(d).css("visibility","visible");c&&c.focus()}function j(d,c){var b=d.val();a("#"+e+" .login_fail").css("visibility","hidden");d.removeClass("error");MGTOOL.trim(b)==""&&(h(c,d),d.addClass("error"))}function k(d,c,b){var f=!1;j(d,"\u8bf7\u8f93\u5165\u7528\u6237\u540d\uff01");j(c,"\u8bf7\u8f93\u5165\u5bc6\u7801\uff01");
b&&(f=l());return a(".error").length>0||f?!1:!0}function l(){if(a(".imgcheck_code_main").length>0){if(!MOGU.imgCodeCheck())return h("\u8bf7\u65cb\u8f6c\u9a8c\u8bc1\u7801\u56fe\u7247\u5230\u6b63\u786e\u65b9\u5411!"),!0}else{var d=a(".check_code");if(d.val()==="")return h("\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801!",d),!0}return!1}function m(){if(a(".imgcheck_code_main").length>0){var d=[],c=0;a("#lb_login input[name='check[]']").each(function(){d[c]=a(this).val();c++});return d}else return a(".check_code").val()}
function n(a,c,b,f){a={user_email:a.val(),user_pass:c.val(),remember:b};if(f)a.check=m();return a}function o(d,b,e){var f=a(".imgcheck_code_main").length==0?!1:!0;if(k(d,b,f)==!1)return!1;d=n(d,b,e,f);jQuery.post("/user/zlogin",d,function(d){if(d==null)alert(MGLANG.msgTimeout);else{var b=d.status.code,f=d.status.msg;b==1001?(MOGUPROFILE.userid=d.result.data.userId,i.success_close("\u767b\u5f55\u6210\u529f\uff01",200),c.callback&&c.callback(d.result.data)):(b==1126||b==1120?a(".imgcheck_code_main").length>
0?MOGU.imgCaptchaRecaptcha():(d=a("#lb_login input[name='user_email']"),b=a(".u_passwd"),g.CHECK.GetImgCheck('<dd id="check_dd" class="check_title shouldremove">&nbsp;</dd><dt id="check_dt" class="clearfix shouldremove"></dt>',"#check_dt",d,b)):MOGU.imgCaptchaRecaptcha(),h(f))}},"json")}var g=this;g.CHECK={FixIe6Bug:function(){a.browser.msie&&a.browser.version=="6.0"&&document.execCommand("BackgroundImageCache",!1,!0)},HasCheckImg:function(a,c){j(a,"\u8bf7\u8f93\u5165\u7528\u6237\u540d\uff01");a.val()==
a.attr("data-lastname")&&a.addClass("error");if(!a.hasClass("error")){var b=a.val();jQuery.post("/user/isloginneedvalid?group=zlogin",{username:b},function(a){c(a)},"json")}},GetImgCheck:function(c,b,e,f){a(b).length>0||jQuery.post("/pcaptcha/getview/zlogin",function(e){if(e.status.code==1001)captcha_html=e.result.captcha,a(b).length>0&&g.CHECK.RemoveImgCheck(),f.after(c),setTimeout(function(){a(b).html(captcha_html).css("opacity",0).animate({opacity:1},1E3);g.CHECK.BindCheckNum()},0)},"json")},RemoveImgCheck:function(){a(".shouldremove").remove();
a(".imgcheckclear").css("visibility","hidden")},BindCheckNum:function(){a(".imgcheck_code_main").length>0?MOGU.imgCaptchaInit():MOGU.Globe_Checkcode_Change()}};(function(){MOGU.Globe_Bind_Keybord_Submit("",a("#"+e+" .login_btn"),"not_need_focus");g.CHECK.FixIe6Bug();var b=a("#lb_login input[name='user_email']"),c=a("#lb_login input[name='user_pass']"),h=a("#"+e+" :checkbox").prop("checked"),f=a(".u_passwd");b.die().live("blur",function(){var b=a(this);b.val();g.CHECK.HasCheckImg(b,function(a){a.status.code==
1001?g.CHECK.GetImgCheck('<dd id="check_dd" class="check_title shouldremove">&nbsp;</dd><dt id="check_dt" class="clearfix shouldremove"></dt>',"#check_dt",b,f):a.status.code==1002&&g.CHECK.RemoveImgCheck();b.attr("data-lastname",b.val())})});a("#"+e+" .login_btn").die().live("click",function(){o(b,c,h)})})()};MOGU.User_Other_login=function(){var b=a("#show_more_login");b.size()>0&&a(".more_login").hover(function(){a(this).addClass("more_login_active");var c=a(this).offset().top+25,e=a(this).offset().left-
90;b.css({top:c,left:e}).show()},function(){var c=a(this),e=setTimeout(function(){b.hide()},1E3);b.hover(function(){clearTimeout(e)},function(){c.removeClass("more_login_active");b.hide()})})};MOGU.User_Find_Password=function(){a(".text").size!=0&&(a(".text").focus(function(){a(this).css("border-color","#83b900")}),a(".text").blur(function(){a(this).css("border-color","#cfcfcf")}))};MOGU.Globe_Checkcode_Change=function(){a("#checkcode_change").size()!=0&&a("#checkcode_change").click(function(){a.ajax({url:"/users/recaptcha",
type:"POST",timeout:6E4,data:"{}",dataType:"json",success:function(b){if(b==null)alert(MGLANG.msgTimeout);else{var c=b.status.msg;b.status.code==1001?(c=b.result.data.captchaId,b=b.result.data.captchaSrc,a("#img_checkcode").attr("src",b),a("#captcha-id").val(c)):alert(c)}},error:function(a,c){"timeout"==c&&alert(MGLANG.msgTimeout)}})})};MOGU.User_Find_Password();jQuery(document).ready(function(){MOGU.User_Other_login()})})(jQuery);
